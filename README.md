# Wasmtime bug

This repository contains a minimal working example to illustrate a change in Wasmtime from version 32 to version 36 
and breaks my use-case.

## Use-case

The struct `Person` has two methods that can be replaced by a WebAssembly component implementing the world
`person-plugin`, defined in `wit/person.wit`.
The methods that can be replaced by a WebAssembly should still be able to call other methods on `self: Person`. 
To achieve this, `self: Person` is made available to the component using a resource.

A basic implementation of a component is found in `person-plugin`.

**Note**: most of the code in this example is meant to be generated by a procedural macro.

## Run the example

```shell
cd person-plugin
cargo component build --release
mv target/wasm32-unknown-unknown/release/person_plugin.wasm ../greetings
cd ../greetings
cargo run
```

## Expected result

This is working fine with `wasmtime 32.0.0`.

```text
Hello Bob (30 yo)
Hello Alice (50 yo)
Hello New Alice (50 yo)
```